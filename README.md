# rip_route_sender_golang

RIPv2 サービスと REST API

このプロジェクトは、RIPv2 (Routing Information Protocol Version 2) のルート情報更新を行うサービスです。このサービスは REST API を通じてルート情報を受け取り、RIPv2 パケットとして他のルータに送信します。また、30秒ごとに定期的にルート情報を送信し、削除されたルートに対してはルートポイゾニング (route poisoning) を行います。

特徴

	•	REST API 経由でルート情報を受信し、RIPv2 パケットとして送信。
	•	RIPv2 更新パケットを送信。
	•	30秒ごとに定期的に RIPv2 更新を送信。
	•	削除されたルートに対してルートポイゾニングを実行 (メトリックを 16 に設定)。

目次

	•	インストール
	•	使用方法
	•	サービスの起動
	•	REST API エンドポイント
	•	リクエスト例
	•	RIPv2 パケットフォーマット
	•	ライセンス

インストール

前提条件

	•	Go 1.20+ がインストールされていること。
	•	ネットワーク環境で UDP サポートがあること (RIPv2 パケット送信用)。

依存関係

必要な Go パッケージ依存関係をインストールします。

go mod tidy

使用方法

サービスの起動

以下のコマンドでサービスを起動します。

go run main.go rest_api.go rip_sender.go

REST API は http://localhost:8080 で利用可能です。

REST API エンドポイント

1. POST /send_route

指定されたルート情報を RIPv2 パケットとして送信します。

	•	リクエストボディ:

{
    "network": "192.168.1.0",
    "mask": "255.255.255.0",
    "metric": 1
}


	•	レスポンス:
	•	ステータス 200 OK: 正常にルートが追加され、RIPv2 パケットが送信された場合。
	•	ステータス 400 Bad Request: 入力が無効な場合。
	•	ステータス 500 Internal Server Error: RIP パケットの送信に失敗した場合。

2. POST /delete_route

指定されたルートを削除し、ルートポイゾニング (メトリック 16 に設定) を実行します。

	•	リクエストボディ:

{
    "network": "192.168.1.0",
    "mask": "255.255.255.0"
}


	•	レスポンス:
	•	ステータス 200 OK: 正常にルートが削除され、ルートポイゾニングが実行された場合。
	•	ステータス 400 Bad Request: 入力が無効な場合。
	•	ステータス 500 Internal Server Error: RIP ポイズンパケットの送信に失敗した場合。

定期的な更新

	•	サービスは、既知の全てのルート情報を30秒ごとに RIPv2 更新パケットとして自動的に送信します。

リクエスト例

1. ルートの追加 (/send_route)

curl -X POST http://localhost:8080/send_route \
    -H "Content-Type: application/json" \
    -d '{
          "network": "192.168.1.0",
          "mask": "255.255.255.0",
          "metric": 1
        }'

2. ルートの削除 (/delete_route)

curl -X POST http://localhost:8080/delete_route \
    -H "Content-Type: application/json" \
    -d '{
          "network": "192.168.1.0",
          "mask": "255.255.255.0"
        }'

RIPv2 パケットフォーマット

RIPv2 プロトコルは UDP を使用し、次のマルチキャストアドレスで通信します。

	•	アドレス: 224.0.0.9
	•	ポート: 520

各 RIPv2 パケットは次の構造を持ちます。

	1.	ヘッダー:
	•	コマンド: 1 (リクエスト) または 2 (レスポンス)
	•	バージョン: 2 (RIPv2)
	•	未使用 (2 バイト): 0 に設定
	2.	エントリ:
各ルートエントリには次の情報が含まれます:
	•	アドレスファミリ識別子: 2 (IP)
	•	IP アドレス: 宛先ネットワーク
	•	サブネットマスク: ネットワークのサブネットマスク
	•	ネクストホップ: 0.0.0.0 に設定 (このプロジェクトでは)
	•	メトリック: 距離 (1-16、16 は到達不能を意味する)


説明

	•	インストール: 必要な依存関係と環境のセットアップ方法を説明しています。
	•	使用方法: サービスの起動方法、REST APIの使用方法について説明しています。
	•	リクエスト例: curlを使用したルートの追加や削除の具体的な例を示しています。
	•	RIPv2 パケットフォーマット: RIPv2 パケットの構造と使用するマルチキャストアドレスやポート番号を説明しています。

